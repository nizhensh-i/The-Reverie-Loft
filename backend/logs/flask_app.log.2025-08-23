[ 2025-08-23 09:17:14 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:28:46 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:28:46 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:28:46 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:28:46 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:28:47 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:28:47 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:28:47 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:28:47 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:28:47 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:28:47 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:28:47 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:28:47 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:28:48 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:28:48 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:28:48 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:28:48 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:28:48 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:28:48 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:28:48 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:28:49 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:28:49 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:28:49 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:28:49 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:28:49 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:29:15 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:29:15 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:29:15 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 09:29:15 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:29:16 - INFO - posts - new_post ]: 创建新文章
[ 2025-08-23 09:29:16 - ERROR - __init__ - error_handler ]: 全局异常: 'NoneType' object has no attribute 'value'
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/api/posts.py", line 147, in new_post
    return success(data=post.to_json())
                        ~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/models.py", line 442, in to_json
    'post_type': self.type.value,
                 ^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'value'
[ 2025-08-23 09:29:16 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:29:16 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 09:29:16 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:29:16 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 09:29:16 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:29:16 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:29:16 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:29:16 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:29:16 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:29:16 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 09:29:16 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:29:16 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 09:29:16 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 09:29:16 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:29:16 - INFO - users - search_followed ]: 搜索关注用户: query=test
[ 2025-08-23 09:29:16 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:29:16 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:29:17 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:29:17 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:29:17 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:29:17 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:29:17 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:29:17 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:29:17 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:29:18 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:29:20 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:29:21 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:31:46 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:31:46 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:31:46 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 09:31:46 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:31:46 - INFO - posts - new_post ]: 创建新文章
[ 2025-08-23 09:31:46 - ERROR - __init__ - error_handler ]: 全局异常: 'NoneType' object has no attribute 'value'
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/api/posts.py", line 147, in new_post
    return success(data=post.to_json())
                        ~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/models.py", line 442, in to_json
    'post_type': self.type.value,
                 ^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'value'
[ 2025-08-23 09:31:46 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:31:46 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 09:31:46 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:31:47 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 09:31:47 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:31:47 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:31:47 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:31:47 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:31:47 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:31:47 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 09:31:47 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:31:47 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 09:31:47 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 09:31:47 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:31:47 - INFO - users - search_followed ]: 搜索关注用户: query=test
[ 2025-08-23 09:31:47 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:31:47 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:31:47 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:31:47 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:31:48 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:31:48 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:31:48 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:31:48 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:31:48 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:31:48 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:31:51 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 09:31:52 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 10:07:48 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 10:07:48 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 10:11:33 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 10:11:33 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 10:11:33 - INFO - posts - new_post ]: 创建新文章
[ 2025-08-23 10:11:33 - ERROR - __init__ - error_handler ]: 全局异常: 'NoneType' object has no attribute 'value'
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/api/posts.py", line 147, in new_post
    return success(data=post.to_json())
                        ~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/models.py", line 442, in to_json
    'post_type': self.type.value,
                 ^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'value'
[ 2025-08-23 10:13:35 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 10:13:35 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 10:13:35 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 10:14:57 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 10:14:58 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 10:14:58 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 10:15:17 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 10:15:17 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 10:15:17 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 10:26:48 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 10:26:48 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 10:26:48 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 10:26:48 - ERROR - __init__ - error_handler ]: 全局异常: Error 8 connecting to none:6379. nodename nor servname provided, or not known.
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 277, in connect
    sock = self.retry.call_with_retry(
        lambda: self._connect(), lambda error: self.disconnect(error)
    )
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/retry.py", line 62, in call_with_retry
    return do()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 278, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
            ~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 607, in _connect
    for res in socket.getaddrinfo(
               ~~~~~~~~~~~~~~~~~~^
        self.host, self.port, self.socket_type, socket.SOCK_STREAM
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 977, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_limiter/extension.py", line 1310, in __inner
    self.limiter._check_request_limit(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        in_middleware=False, callable_name=name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_limiter/extension.py", line 1187, in _check_request_limit
    raise e
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_limiter/extension.py", line 1169, in _check_request_limit
    self.__evaluate_limits(endpoint, all_limits)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_limiter/extension.py", line 1101, in __evaluate_limits
    if not method(lim.limit, *args, **kwargs):
           ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/limits/strategies.py", line 157, in hit
    self.storage.incr(
    ~~~~~~~~~~~~~~~~~^
        item.key_for(*identifiers),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
        item.get_expiry(),
        ^^^^^^^^^^^^^^^^^^
        amount=cost,
        ^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/limits/storage/base.py", line 25, in inner
    return fn(*args, **kwargs)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/limits/storage/redis.py", line 224, in incr
    return int(self.lua_incr_expire([key], [expiry, amount]))
               ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/commands/core.py", line 6296, in __call__
    return client.evalsha(self.sha, len(keys), *args)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/commands/core.py", line 5672, in evalsha
    return self._evalsha("EVALSHA", sha, numkeys, *keys_and_args)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/commands/core.py", line 5656, in _evalsha
    return self.execute_command(command, sha, numkeys, *keys_and_args)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/client.py", line 545, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 1074, in get_connection
    connection.connect()
    ~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 283, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 8 connecting to none:6379. nodename nor servname provided, or not known.
[ 2025-08-23 10:28:24 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 10:28:24 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 10:28:24 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 10:30:30 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 10:30:31 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 10:30:31 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 10:31:01 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 10:31:01 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 10:31:01 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 10:32:02 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 10:32:02 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 10:32:02 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 10:32:22 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 10:32:22 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 10:32:22 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 10:37:30 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 10:37:31 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 10:37:31 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 10:37:31 - ERROR - __init__ - error_handler ]: 全局异常: Error 8 connecting to none:6379. nodename nor servname provided, or not known.
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 277, in connect
    sock = self.retry.call_with_retry(
        lambda: self._connect(), lambda error: self.disconnect(error)
    )
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/retry.py", line 62, in call_with_retry
    return do()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 278, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
            ~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 607, in _connect
    for res in socket.getaddrinfo(
               ~~~~~~~~~~~~~~~~~~^
        self.host, self.port, self.socket_type, socket.SOCK_STREAM
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 977, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_limiter/extension.py", line 1310, in __inner
    self.limiter._check_request_limit(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        in_middleware=False, callable_name=name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_limiter/extension.py", line 1187, in _check_request_limit
    raise e
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_limiter/extension.py", line 1169, in _check_request_limit
    self.__evaluate_limits(endpoint, all_limits)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_limiter/extension.py", line 1101, in __evaluate_limits
    if not method(lim.limit, *args, **kwargs):
           ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/limits/strategies.py", line 157, in hit
    self.storage.incr(
    ~~~~~~~~~~~~~~~~~^
        item.key_for(*identifiers),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
        item.get_expiry(),
        ^^^^^^^^^^^^^^^^^^
        amount=cost,
        ^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/limits/storage/base.py", line 25, in inner
    return fn(*args, **kwargs)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/limits/storage/redis.py", line 224, in incr
    return int(self.lua_incr_expire([key], [expiry, amount]))
               ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/commands/core.py", line 6296, in __call__
    return client.evalsha(self.sha, len(keys), *args)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/commands/core.py", line 5672, in evalsha
    return self._evalsha("EVALSHA", sha, numkeys, *keys_and_args)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/commands/core.py", line 5656, in _evalsha
    return self.execute_command(command, sha, numkeys, *keys_and_args)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/client.py", line 545, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 1074, in get_connection
    connection.connect()
    ~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 283, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 8 connecting to none:6379. nodename nor servname provided, or not known.
[ 2025-08-23 10:37:43 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 10:37:43 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 10:37:43 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 10:37:43 - ERROR - posts - index ]: 创建文章失败: 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/main/posts.py", line 41, in index
    url=image.get("url", ""),
        ^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
[ 2025-08-23 10:48:29 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 10:48:29 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 10:48:30 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 10:48:30 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 10:49:17 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 10:49:18 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 10:49:18 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 10:49:18 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 10:49:28 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 10:49:29 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 10:49:29 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 10:49:29 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 10:49:55 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 10:49:56 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 10:49:56 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 10:49:56 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 10:50:28 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 10:50:28 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 10:50:28 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 10:50:28 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 10:50:47 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 10:50:48 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 10:50:48 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 10:50:48 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 10:53:14 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 10:53:15 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 10:53:15 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 10:53:15 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 10:53:32 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 10:53:32 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 10:53:32 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 10:53:32 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 10:55:00 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 10:55:00 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 10:55:00 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 10:55:00 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 10:57:15 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 10:57:15 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 10:57:15 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 10:57:15 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 11:00:29 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 11:00:29 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 11:00:29 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 11:00:29 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 14:46:40 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 14:46:40 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 14:46:40 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 14:46:40 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 15:04:21 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 15:04:22 - ERROR - __init__ - error_handler ]: 全局异常: 'NoneType' object has no attribute 'email' and no __dict__ for setting new attributes
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_jwt_extended/view_decorators.py", line 170, in decorator
    return current_app.ensure_sync(fn)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/utils/time_util.py", line 57, in decorate
    result = func(*args, **kwargs)
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/auth/views.py", line 81, in apply_code
    current_user.email = request.get_json().get('email')
    ^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'email' and no __dict__ for setting new attributes
[ 2025-08-23 15:06:58 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 15:06:58 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 15:06:58 - INFO - comments - new_post_comment ]: 创建新评论: post_id=1
[ 2025-08-23 15:06:58 - ERROR - comments - new_post_comment ]: 创建评论失败: name 'g' is not defined
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/api/comments.py", line 156, in new_post_comment
    comment.author = g.current_user
                     ^
NameError: name 'g' is not defined
[ 2025-08-23 15:06:58 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 15:06:58 - INFO - comments - new_post_comment ]: 创建新评论: post_id=1
[ 2025-08-23 15:06:58 - ERROR - comments - new_post_comment ]: 创建评论失败: name 'g' is not defined
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/api/comments.py", line 156, in new_post_comment
    comment.author = g.current_user
                     ^
NameError: name 'g' is not defined
[ 2025-08-23 15:06:58 - WARNING - errors - page_not_found ]: 404错误: /comment/None/reply
[ 2025-08-23 15:07:37 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 15:07:37 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 15:07:37 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 15:07:37 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 15:07:37 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 15:07:37 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 15:07:37 - ERROR - __init__ - error_handler ]: 全局异常: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$VdCpCV4w7HgYgy1u$187ba60b8806f091b629f72c04ed4f7c4da797bf96c8752ebd73706eb4c959e5da0212eff5d85c1994a89a9b481ad09ad4f305930645d0e401be5bd4f3c48c98', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:07:37', 'last_seen': '2025-08-23 15:07:37', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
    ~~~~~~~~~~^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
    ~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/auth/views.py", line 65, in register
    db.session.commit()
    ~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/scoping.py", line 597, in commit
    return self._proxied.commit()
           ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2028, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4352, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4487, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper,
        ^^^^^^^^^^^^
    ...<3 lines>...
        insert,
        ^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
        statement,
        params,
        execution_options=execution_options,
    )
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
    ~~~~~~~~~~^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
    ~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$VdCpCV4w7HgYgy1u$187ba60b8806f091b629f72c04ed4f7c4da797bf96c8752ebd73706eb4c959e5da0212eff5d85c1994a89a9b481ad09ad4f305930645d0e401be5bd4f3c48c98', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:07:37', 'last_seen': '2025-08-23 15:07:37', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
[ 2025-08-23 15:07:37 - ERROR - __init__ - error_handler ]: 全局异常: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$VdCpCV4w7HgYgy1u$187ba60b8806f091b629f72c04ed4f7c4da797bf96c8752ebd73706eb4c959e5da0212eff5d85c1994a89a9b481ad09ad4f305930645d0e401be5bd4f3c48c98', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:07:37', 'last_seen': '2025-08-23 15:07:37', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/auth/views.py", line 26, in login
    user = User.query.filter_by(username=j.get('uiAccountName')).one_or_none()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 2754, in one_or_none
    return self._iter().one_or_none()  # type: ignore
           ~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 103, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 973, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
    ...<6 lines>...
    )
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$VdCpCV4w7HgYgy1u$187ba60b8806f091b629f72c04ed4f7c4da797bf96c8752ebd73706eb4c959e5da0212eff5d85c1994a89a9b481ad09ad4f305930645d0e401be5bd4f3c48c98', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:07:37', 'last_seen': '2025-08-23 15:07:37', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
[ 2025-08-23 15:07:37 - ERROR - __init__ - error_handler ]: 全局异常: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$VdCpCV4w7HgYgy1u$187ba60b8806f091b629f72c04ed4f7c4da797bf96c8752ebd73706eb4c959e5da0212eff5d85c1994a89a9b481ad09ad4f305930645d0e401be5bd4f3c48c98', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:07:37', 'last_seen': '2025-08-23 15:07:37', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/auth/views.py", line 57, in register
    u = User.query.filter_by(username=j.get('username')).first()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 103, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 973, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
    ...<6 lines>...
    )
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$VdCpCV4w7HgYgy1u$187ba60b8806f091b629f72c04ed4f7c4da797bf96c8752ebd73706eb4c959e5da0212eff5d85c1994a89a9b481ad09ad4f305930645d0e401be5bd4f3c48c98', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:07:37', 'last_seen': '2025-08-23 15:07:37', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
[ 2025-08-23 15:07:37 - ERROR - __init__ - error_handler ]: 全局异常: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$VdCpCV4w7HgYgy1u$187ba60b8806f091b629f72c04ed4f7c4da797bf96c8752ebd73706eb4c959e5da0212eff5d85c1994a89a9b481ad09ad4f305930645d0e401be5bd4f3c48c98', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:07:37', 'last_seen': '2025-08-23 15:07:37', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/auth/views.py", line 26, in login
    user = User.query.filter_by(username=j.get('uiAccountName')).one_or_none()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 2754, in one_or_none
    return self._iter().one_or_none()  # type: ignore
           ~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 103, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 973, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
    ...<6 lines>...
    )
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$VdCpCV4w7HgYgy1u$187ba60b8806f091b629f72c04ed4f7c4da797bf96c8752ebd73706eb4c959e5da0212eff5d85c1994a89a9b481ad09ad4f305930645d0e401be5bd4f3c48c98', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:07:37', 'last_seen': '2025-08-23 15:07:37', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
[ 2025-08-23 15:07:37 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 15:07:37 - ERROR - __init__ - error_handler ]: 全局异常: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$VdCpCV4w7HgYgy1u$187ba60b8806f091b629f72c04ed4f7c4da797bf96c8752ebd73706eb4c959e5da0212eff5d85c1994a89a9b481ad09ad4f305930645d0e401be5bd4f3c48c98', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:07:37', 'last_seen': '2025-08-23 15:07:37', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/api/users.py", line 61, in get_user
    user = User.query.get_or_404(id)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_sqlalchemy/query.py", line 30, in get_or_404
    rv = self.get(ident)
  File "<string>", line 2, in get
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/deprecations.py", line 386, in warned
    return fn(*args, **kwargs)  # type: ignore[no-any-return]
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 1127, in get
    return self._get_impl(ident, loading.load_on_pk_identity)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 1136, in _get_impl
    return self.session._get_impl(
           ~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<6 lines>...
        execution_options=self._execution_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 3873, in _get_impl
    return db_load_fn(
        self,
    ...<5 lines>...
        bind_arguments=bind_arguments,
    )
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
    ~~~~~~~~~~~~~~~^
        q,
        ^^
    ...<2 lines>...
        bind_arguments=bind_arguments,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 103, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 973, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
    ...<6 lines>...
    )
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$VdCpCV4w7HgYgy1u$187ba60b8806f091b629f72c04ed4f7c4da797bf96c8752ebd73706eb4c959e5da0212eff5d85c1994a89a9b481ad09ad4f305930645d0e401be5bd4f3c48c98', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:07:37', 'last_seen': '2025-08-23 15:07:37', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
[ 2025-08-23 15:07:37 - INFO - users - get_user ]: 获取用户信息: id=2
[ 2025-08-23 15:07:37 - ERROR - __init__ - error_handler ]: 全局异常: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$VdCpCV4w7HgYgy1u$187ba60b8806f091b629f72c04ed4f7c4da797bf96c8752ebd73706eb4c959e5da0212eff5d85c1994a89a9b481ad09ad4f305930645d0e401be5bd4f3c48c98', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:07:37', 'last_seen': '2025-08-23 15:07:37', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/api/users.py", line 61, in get_user
    user = User.query.get_or_404(id)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_sqlalchemy/query.py", line 30, in get_or_404
    rv = self.get(ident)
  File "<string>", line 2, in get
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/deprecations.py", line 386, in warned
    return fn(*args, **kwargs)  # type: ignore[no-any-return]
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 1127, in get
    return self._get_impl(ident, loading.load_on_pk_identity)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 1136, in _get_impl
    return self.session._get_impl(
           ~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<6 lines>...
        execution_options=self._execution_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 3873, in _get_impl
    return db_load_fn(
        self,
    ...<5 lines>...
        bind_arguments=bind_arguments,
    )
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
    ~~~~~~~~~~~~~~~^
        q,
        ^^
    ...<2 lines>...
        bind_arguments=bind_arguments,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 103, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 973, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
    ...<6 lines>...
    )
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$VdCpCV4w7HgYgy1u$187ba60b8806f091b629f72c04ed4f7c4da797bf96c8752ebd73706eb4c959e5da0212eff5d85c1994a89a9b481ad09ad4f305930645d0e401be5bd4f3c48c98', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:07:37', 'last_seen': '2025-08-23 15:07:37', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
[ 2025-08-23 15:07:37 - ERROR - __init__ - error_handler ]: 全局异常: 405 Method Not Allowed: The method is not allowed for the requested URL.
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 854, in dispatch_request
    self.raise_routing_exception(req)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 463, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/werkzeug/routing/map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
[ 2025-08-23 15:09:15 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 15:09:15 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 15:09:15 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 15:09:15 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 15:09:15 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 15:09:15 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 15:09:15 - ERROR - __init__ - error_handler ]: 全局异常: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$QrWf4bgDV4TbzJcK$9c8466ded349380cc71c669cc6bc7faab2d77b5a7f19cd5f4b694ba2f20ec95178954a22dd5887d91c7ba3e46de647410f9b6f989e96b8bde59f6f546f25e9ff', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:09:15', 'last_seen': '2025-08-23 15:09:15', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
    ~~~~~~~~~~^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
    ~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/auth/views.py", line 65, in register
    db.session.commit()
    ~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/scoping.py", line 597, in commit
    return self._proxied.commit()
           ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2028, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4352, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4487, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper,
        ^^^^^^^^^^^^
    ...<3 lines>...
        insert,
        ^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
        statement,
        params,
        execution_options=execution_options,
    )
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
    ~~~~~~~~~~^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
    ~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$QrWf4bgDV4TbzJcK$9c8466ded349380cc71c669cc6bc7faab2d77b5a7f19cd5f4b694ba2f20ec95178954a22dd5887d91c7ba3e46de647410f9b6f989e96b8bde59f6f546f25e9ff', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:09:15', 'last_seen': '2025-08-23 15:09:15', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
[ 2025-08-23 15:09:15 - ERROR - __init__ - error_handler ]: 全局异常: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$QrWf4bgDV4TbzJcK$9c8466ded349380cc71c669cc6bc7faab2d77b5a7f19cd5f4b694ba2f20ec95178954a22dd5887d91c7ba3e46de647410f9b6f989e96b8bde59f6f546f25e9ff', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:09:15', 'last_seen': '2025-08-23 15:09:15', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/auth/views.py", line 26, in login
    user = User.query.filter_by(username=j.get('uiAccountName')).one_or_none()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 2754, in one_or_none
    return self._iter().one_or_none()  # type: ignore
           ~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 103, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 973, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
    ...<6 lines>...
    )
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$QrWf4bgDV4TbzJcK$9c8466ded349380cc71c669cc6bc7faab2d77b5a7f19cd5f4b694ba2f20ec95178954a22dd5887d91c7ba3e46de647410f9b6f989e96b8bde59f6f546f25e9ff', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:09:15', 'last_seen': '2025-08-23 15:09:15', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
[ 2025-08-23 15:09:15 - ERROR - __init__ - error_handler ]: 全局异常: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$QrWf4bgDV4TbzJcK$9c8466ded349380cc71c669cc6bc7faab2d77b5a7f19cd5f4b694ba2f20ec95178954a22dd5887d91c7ba3e46de647410f9b6f989e96b8bde59f6f546f25e9ff', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:09:15', 'last_seen': '2025-08-23 15:09:15', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/auth/views.py", line 57, in register
    u = User.query.filter_by(username=j.get('username')).first()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 103, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 973, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
    ...<6 lines>...
    )
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$QrWf4bgDV4TbzJcK$9c8466ded349380cc71c669cc6bc7faab2d77b5a7f19cd5f4b694ba2f20ec95178954a22dd5887d91c7ba3e46de647410f9b6f989e96b8bde59f6f546f25e9ff', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:09:15', 'last_seen': '2025-08-23 15:09:15', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
[ 2025-08-23 15:09:15 - ERROR - __init__ - error_handler ]: 全局异常: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$QrWf4bgDV4TbzJcK$9c8466ded349380cc71c669cc6bc7faab2d77b5a7f19cd5f4b694ba2f20ec95178954a22dd5887d91c7ba3e46de647410f9b6f989e96b8bde59f6f546f25e9ff', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:09:15', 'last_seen': '2025-08-23 15:09:15', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/auth/views.py", line 26, in login
    user = User.query.filter_by(username=j.get('uiAccountName')).one_or_none()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 2754, in one_or_none
    return self._iter().one_or_none()  # type: ignore
           ~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 103, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 973, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
    ...<6 lines>...
    )
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$QrWf4bgDV4TbzJcK$9c8466ded349380cc71c669cc6bc7faab2d77b5a7f19cd5f4b694ba2f20ec95178954a22dd5887d91c7ba3e46de647410f9b6f989e96b8bde59f6f546f25e9ff', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:09:15', 'last_seen': '2025-08-23 15:09:15', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
[ 2025-08-23 15:09:15 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 15:09:15 - ERROR - __init__ - error_handler ]: 全局异常: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$QrWf4bgDV4TbzJcK$9c8466ded349380cc71c669cc6bc7faab2d77b5a7f19cd5f4b694ba2f20ec95178954a22dd5887d91c7ba3e46de647410f9b6f989e96b8bde59f6f546f25e9ff', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:09:15', 'last_seen': '2025-08-23 15:09:15', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/api/users.py", line 61, in get_user
    user = User.query.get_or_404(id)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_sqlalchemy/query.py", line 30, in get_or_404
    rv = self.get(ident)
  File "<string>", line 2, in get
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/deprecations.py", line 386, in warned
    return fn(*args, **kwargs)  # type: ignore[no-any-return]
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 1127, in get
    return self._get_impl(ident, loading.load_on_pk_identity)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 1136, in _get_impl
    return self.session._get_impl(
           ~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<6 lines>...
        execution_options=self._execution_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 3873, in _get_impl
    return db_load_fn(
        self,
    ...<5 lines>...
        bind_arguments=bind_arguments,
    )
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
    ~~~~~~~~~~~~~~~^
        q,
        ^^
    ...<2 lines>...
        bind_arguments=bind_arguments,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 103, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 973, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
    ...<6 lines>...
    )
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$QrWf4bgDV4TbzJcK$9c8466ded349380cc71c669cc6bc7faab2d77b5a7f19cd5f4b694ba2f20ec95178954a22dd5887d91c7ba3e46de647410f9b6f989e96b8bde59f6f546f25e9ff', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:09:15', 'last_seen': '2025-08-23 15:09:15', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
[ 2025-08-23 15:09:15 - INFO - users - get_user ]: 获取用户信息: id=2
[ 2025-08-23 15:09:15 - ERROR - __init__ - error_handler ]: 全局异常: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$QrWf4bgDV4TbzJcK$9c8466ded349380cc71c669cc6bc7faab2d77b5a7f19cd5f4b694ba2f20ec95178954a22dd5887d91c7ba3e46de647410f9b6f989e96b8bde59f6f546f25e9ff', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:09:15', 'last_seen': '2025-08-23 15:09:15', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/api/users.py", line 61, in get_user
    user = User.query.get_or_404(id)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_sqlalchemy/query.py", line 30, in get_or_404
    rv = self.get(ident)
  File "<string>", line 2, in get
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/deprecations.py", line 386, in warned
    return fn(*args, **kwargs)  # type: ignore[no-any-return]
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 1127, in get
    return self._get_impl(ident, loading.load_on_pk_identity)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 1136, in _get_impl
    return self.session._get_impl(
           ~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<6 lines>...
        execution_options=self._execution_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 3873, in _get_impl
    return db_load_fn(
        self,
    ...<5 lines>...
        bind_arguments=bind_arguments,
    )
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
    ~~~~~~~~~~~~~~~^
        q,
        ^^
    ...<2 lines>...
        bind_arguments=bind_arguments,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 103, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 973, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
    ...<6 lines>...
    )
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$QrWf4bgDV4TbzJcK$9c8466ded349380cc71c669cc6bc7faab2d77b5a7f19cd5f4b694ba2f20ec95178954a22dd5887d91c7ba3e46de647410f9b6f989e96b8bde59f6f546f25e9ff', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:09:15', 'last_seen': '2025-08-23 15:09:15', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
[ 2025-08-23 15:09:15 - ERROR - __init__ - error_handler ]: 全局异常: 405 Method Not Allowed: The method is not allowed for the requested URL.
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 854, in dispatch_request
    self.raise_routing_exception(req)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 463, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/werkzeug/routing/map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
[ 2025-08-23 15:09:59 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 15:10:00 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 15:10:00 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 15:10:00 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 15:10:00 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 15:10:00 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 15:10:00 - ERROR - __init__ - error_handler ]: 全局异常: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$4dudWA2QRGB4k3io$892370dfbf3dfe80a192a6c355a4c44982bb7c2ea74f34d03ca5c73f0465e521c39afc49b7928ec5613ba85977f2ab04ea497f678be9242f49d242a37b3e18ce', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:10:00', 'last_seen': '2025-08-23 15:10:00', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
    ~~~~~~~~~~^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
    ~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/auth/views.py", line 65, in register
    db.session.commit()
    ~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/scoping.py", line 597, in commit
    return self._proxied.commit()
           ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2028, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4352, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4487, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper,
        ^^^^^^^^^^^^
    ...<3 lines>...
        insert,
        ^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
        statement,
        params,
        execution_options=execution_options,
    )
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
    ~~~~~~~~~~^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
    ~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$4dudWA2QRGB4k3io$892370dfbf3dfe80a192a6c355a4c44982bb7c2ea74f34d03ca5c73f0465e521c39afc49b7928ec5613ba85977f2ab04ea497f678be9242f49d242a37b3e18ce', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:10:00', 'last_seen': '2025-08-23 15:10:00', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
[ 2025-08-23 15:10:00 - ERROR - __init__ - error_handler ]: 全局异常: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$4dudWA2QRGB4k3io$892370dfbf3dfe80a192a6c355a4c44982bb7c2ea74f34d03ca5c73f0465e521c39afc49b7928ec5613ba85977f2ab04ea497f678be9242f49d242a37b3e18ce', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:10:00', 'last_seen': '2025-08-23 15:10:00', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/auth/views.py", line 26, in login
    user = User.query.filter_by(username=j.get('uiAccountName')).one_or_none()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 2754, in one_or_none
    return self._iter().one_or_none()  # type: ignore
           ~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 103, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 973, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
    ...<6 lines>...
    )
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$4dudWA2QRGB4k3io$892370dfbf3dfe80a192a6c355a4c44982bb7c2ea74f34d03ca5c73f0465e521c39afc49b7928ec5613ba85977f2ab04ea497f678be9242f49d242a37b3e18ce', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:10:00', 'last_seen': '2025-08-23 15:10:00', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
[ 2025-08-23 15:10:00 - ERROR - __init__ - error_handler ]: 全局异常: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$4dudWA2QRGB4k3io$892370dfbf3dfe80a192a6c355a4c44982bb7c2ea74f34d03ca5c73f0465e521c39afc49b7928ec5613ba85977f2ab04ea497f678be9242f49d242a37b3e18ce', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:10:00', 'last_seen': '2025-08-23 15:10:00', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/auth/views.py", line 57, in register
    u = User.query.filter_by(username=j.get('username')).first()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 103, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 973, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
    ...<6 lines>...
    )
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$4dudWA2QRGB4k3io$892370dfbf3dfe80a192a6c355a4c44982bb7c2ea74f34d03ca5c73f0465e521c39afc49b7928ec5613ba85977f2ab04ea497f678be9242f49d242a37b3e18ce', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:10:00', 'last_seen': '2025-08-23 15:10:00', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
[ 2025-08-23 15:10:00 - ERROR - __init__ - error_handler ]: 全局异常: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$4dudWA2QRGB4k3io$892370dfbf3dfe80a192a6c355a4c44982bb7c2ea74f34d03ca5c73f0465e521c39afc49b7928ec5613ba85977f2ab04ea497f678be9242f49d242a37b3e18ce', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:10:00', 'last_seen': '2025-08-23 15:10:00', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/auth/views.py", line 26, in login
    user = User.query.filter_by(username=j.get('uiAccountName')).one_or_none()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 2754, in one_or_none
    return self._iter().one_or_none()  # type: ignore
           ~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 103, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 973, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
    ...<6 lines>...
    )
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$4dudWA2QRGB4k3io$892370dfbf3dfe80a192a6c355a4c44982bb7c2ea74f34d03ca5c73f0465e521c39afc49b7928ec5613ba85977f2ab04ea497f678be9242f49d242a37b3e18ce', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:10:00', 'last_seen': '2025-08-23 15:10:00', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
[ 2025-08-23 15:10:00 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 15:10:00 - ERROR - __init__ - error_handler ]: 全局异常: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$4dudWA2QRGB4k3io$892370dfbf3dfe80a192a6c355a4c44982bb7c2ea74f34d03ca5c73f0465e521c39afc49b7928ec5613ba85977f2ab04ea497f678be9242f49d242a37b3e18ce', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:10:00', 'last_seen': '2025-08-23 15:10:00', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/api/users.py", line 61, in get_user
    user = User.query.get_or_404(id)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_sqlalchemy/query.py", line 30, in get_or_404
    rv = self.get(ident)
  File "<string>", line 2, in get
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/deprecations.py", line 386, in warned
    return fn(*args, **kwargs)  # type: ignore[no-any-return]
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 1127, in get
    return self._get_impl(ident, loading.load_on_pk_identity)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 1136, in _get_impl
    return self.session._get_impl(
           ~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<6 lines>...
        execution_options=self._execution_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 3873, in _get_impl
    return db_load_fn(
        self,
    ...<5 lines>...
        bind_arguments=bind_arguments,
    )
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
    ~~~~~~~~~~~~~~~^
        q,
        ^^
    ...<2 lines>...
        bind_arguments=bind_arguments,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 103, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 973, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
    ...<6 lines>...
    )
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$4dudWA2QRGB4k3io$892370dfbf3dfe80a192a6c355a4c44982bb7c2ea74f34d03ca5c73f0465e521c39afc49b7928ec5613ba85977f2ab04ea497f678be9242f49d242a37b3e18ce', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:10:00', 'last_seen': '2025-08-23 15:10:00', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
[ 2025-08-23 15:10:00 - INFO - users - get_user ]: 获取用户信息: id=2
[ 2025-08-23 15:10:00 - ERROR - __init__ - error_handler ]: 全局异常: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$4dudWA2QRGB4k3io$892370dfbf3dfe80a192a6c355a4c44982bb7c2ea74f34d03ca5c73f0465e521c39afc49b7928ec5613ba85977f2ab04ea497f678be9242f49d242a37b3e18ce', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:10:00', 'last_seen': '2025-08-23 15:10:00', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/api/users.py", line 61, in get_user
    user = User.query.get_or_404(id)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_sqlalchemy/query.py", line 30, in get_or_404
    rv = self.get(ident)
  File "<string>", line 2, in get
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/util/deprecations.py", line 386, in warned
    return fn(*args, **kwargs)  # type: ignore[no-any-return]
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 1127, in get
    return self._get_impl(ident, loading.load_on_pk_identity)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/query.py", line 1136, in _get_impl
    return self.session._get_impl(
           ~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<6 lines>...
        execution_options=self._execution_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 3873, in _get_impl
    return db_load_fn(
        self,
    ...<5 lines>...
        bind_arguments=bind_arguments,
    )
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/loading.py", line 694, in load_on_pk_identity
    session.execute(
    ~~~~~~~~~~~~~~~^
        q,
        ^^
    ...<2 lines>...
        bind_arguments=bind_arguments,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 103, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 973, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
    ...<6 lines>...
    )
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'zmc_li@foxmail.com' for key 'users.ix_users_email'")
[SQL: INSERT INTO users (email, username, password_hash, confirmed, nickname, location, about_me, sex, bg_image, member_since, last_seen, image, role_id, social_account) VALUES (%(email)s, %(username)s, %(password_hash)s, %(confirmed)s, %(nickname)s, %(location)s, %(about_me)s, %(sex)s, %(bg_image)s, %(member_since)s, %(last_seen)s, %(image)s, %(role_id)s, %(social_account)s)]
[parameters: {'email': 'zmc_li@foxmail.com', 'username': 'user1', 'password_hash': 'scrypt:32768:8:1$4dudWA2QRGB4k3io$892370dfbf3dfe80a192a6c355a4c44982bb7c2ea74f34d03ca5c73f0465e521c39afc49b7928ec5613ba85977f2ab04ea497f678be9242f49d242a37b3e18ce', 'confirmed': 0, 'nickname': None, 'location': None, 'about_me': None, 'sex': None, 'bg_image': None, 'member_since': '2025-08-23 15:10:00', 'last_seen': '2025-08-23 15:10:00', 'image': '', 'role_id': 1, 'social_account': '{"github": null, "qq": null, "wechat": null, "bilibili": null, "twitter": null, "tiktok": null, "rednote": null, "email": null}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
[ 2025-08-23 15:10:00 - ERROR - __init__ - error_handler ]: 全局异常: 405 Method Not Allowed: The method is not allowed for the requested URL.
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 854, in dispatch_request
    self.raise_routing_exception(req)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 463, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/werkzeug/routing/map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
[ 2025-08-23 15:12:49 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 15:12:50 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 15:12:50 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 15:12:50 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 15:12:50 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 15:12:50 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 15:12:50 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 15:12:50 - INFO - users - get_user ]: 获取用户信息: id=2
[ 2025-08-23 15:12:50 - ERROR - __init__ - error_handler ]: 全局异常: 405 Method Not Allowed: The method is not allowed for the requested URL.
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 854, in dispatch_request
    self.raise_routing_exception(req)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 463, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/werkzeug/routing/map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
[ 2025-08-23 15:15:21 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 15:15:22 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 15:15:22 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 15:15:22 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 15:15:22 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 15:15:22 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 15:15:22 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 15:15:22 - INFO - users - get_user ]: 获取用户信息: id=2
[ 2025-08-23 15:15:22 - INFO - follow - follow ]: 关注用户: user2 -> 1
[ 2025-08-23 15:18:12 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 15:18:12 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 15:18:12 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 15:18:12 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 15:18:13 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 15:18:13 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 15:18:13 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 15:18:13 - INFO - users - get_user ]: 获取用户信息: id=2
[ 2025-08-23 15:18:13 - INFO - follow - follow ]: 关注用户: user2 -> 1
[ 2025-08-23 15:18:48 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 15:18:48 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 15:18:48 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 15:18:48 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 15:18:48 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 15:18:48 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 15:18:48 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 15:18:48 - INFO - users - get_user ]: 获取用户信息: id=2
[ 2025-08-23 15:18:48 - INFO - follow - follow ]: 关注用户: user2 -> test
[ 2025-08-23 15:18:48 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 15:18:48 - INFO - follow - unfollow ]: 取消关注用户: user2 -> test
[ 2025-08-23 15:18:48 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 15:19:23 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 15:19:23 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 15:19:23 - INFO - comments - new_post_comment ]: 创建新评论: post_id=1
[ 2025-08-23 15:19:23 - ERROR - comments - new_post_comment ]: 创建评论失败: name 'g' is not defined
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/api/comments.py", line 156, in new_post_comment
    comment.author = g.current_user
                     ^
NameError: name 'g' is not defined
[ 2025-08-23 15:19:24 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 15:19:24 - INFO - comments - new_post_comment ]: 创建新评论: post_id=2
[ 2025-08-23 15:19:24 - ERROR - comments - new_post_comment ]: 创建评论失败: name 'g' is not defined
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/api/comments.py", line 156, in new_post_comment
    comment.author = g.current_user
                     ^
NameError: name 'g' is not defined
[ 2025-08-23 15:19:24 - WARNING - errors - page_not_found ]: 404错误: /comment/None/reply
[ 2025-08-23 15:19:37 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 15:19:37 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 15:19:37 - INFO - comments - new_post_comment ]: 创建新评论: post_id=1
[ 2025-08-23 15:19:37 - ERROR - comments - new_post_comment ]: 创建评论失败: name 'g' is not defined
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/api/comments.py", line 156, in new_post_comment
    comment.author = g.current_user
                     ^
NameError: name 'g' is not defined
[ 2025-08-23 15:19:38 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 15:19:38 - INFO - praise - praise ]: 文章点赞: id=2
[ 2025-08-23 15:19:38 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 15:19:38 - INFO - posts - index ]: 创建新文章: user_id=4, post_id=3
[ 2025-08-23 15:19:38 - INFO - comments - new_post_comment ]: 创建新评论: post_id=2
[ 2025-08-23 15:19:38 - ERROR - comments - new_post_comment ]: 创建评论失败: name 'g' is not defined
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/api/comments.py", line 156, in new_post_comment
    comment.author = g.current_user
                     ^
NameError: name 'g' is not defined
[ 2025-08-23 15:19:38 - WARNING - errors - page_not_found ]: 404错误: /comment/None/reply
[ 2025-08-23 15:19:38 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=4
[ 2025-08-23 15:19:38 - INFO - comments - new_post_comment ]: 创建新评论: post_id=2
[ 2025-08-23 15:19:38 - ERROR - comments - new_post_comment ]: 创建评论失败: name 'g' is not defined
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/api/comments.py", line 156, in new_post_comment
    comment.author = g.current_user
                     ^
NameError: name 'g' is not defined
[ 2025-08-23 15:19:38 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 15:19:38 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=1
[ 2025-08-23 15:19:38 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 15:19:47 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 15:19:47 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 15:19:47 - INFO - comments - new_post_comment ]: 创建新评论: post_id=1
[ 2025-08-23 15:19:47 - ERROR - comments - new_post_comment ]: 创建评论失败: name 'g' is not defined
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/api/comments.py", line 156, in new_post_comment
    comment.author = g.current_user
                     ^
NameError: name 'g' is not defined
[ 2025-08-23 15:19:47 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 15:19:48 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 15:19:48 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 15:19:48 - INFO - posts - index ]: 创建新文章: user_id=4, post_id=3
[ 2025-08-23 15:19:48 - INFO - comments - new_post_comment ]: 创建新评论: post_id=3
[ 2025-08-23 15:19:48 - ERROR - comments - new_post_comment ]: 创建评论失败: name 'g' is not defined
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/api/comments.py", line 156, in new_post_comment
    comment.author = g.current_user
                     ^
NameError: name 'g' is not defined
[ 2025-08-23 15:19:48 - WARNING - errors - page_not_found ]: 404错误: /comment/None/reply
[ 2025-08-23 15:19:48 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=4
[ 2025-08-23 15:19:48 - INFO - comments - new_post_comment ]: 创建新评论: post_id=3
[ 2025-08-23 15:19:48 - ERROR - comments - new_post_comment ]: 创建评论失败: name 'g' is not defined
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/api/comments.py", line 156, in new_post_comment
    comment.author = g.current_user
                     ^
NameError: name 'g' is not defined
[ 2025-08-23 15:19:48 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 15:19:48 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=1
[ 2025-08-23 15:19:48 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 15:19:58 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 15:19:59 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 15:19:59 - INFO - comments - new_post_comment ]: 创建新评论: post_id=1
[ 2025-08-23 15:19:59 - ERROR - comments - new_post_comment ]: 创建评论失败: name 'g' is not defined
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/api/comments.py", line 156, in new_post_comment
    comment.author = g.current_user
                     ^
NameError: name 'g' is not defined
[ 2025-08-23 15:19:59 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 15:19:59 - INFO - comments - new_post_comment ]: 创建新评论: post_id=1
[ 2025-08-23 15:19:59 - ERROR - comments - new_post_comment ]: 创建评论失败: name 'g' is not defined
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/api/comments.py", line 156, in new_post_comment
    comment.author = g.current_user
                     ^
NameError: name 'g' is not defined
[ 2025-08-23 15:19:59 - WARNING - errors - page_not_found ]: 404错误: /comment/None/reply
[ 2025-08-23 15:30:42 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 15:30:42 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 15:30:42 - WARNING - errors - page_not_found ]: 404错误: /posts/1
[ 2025-08-23 15:30:42 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 15:30:42 - ERROR - __init__ - error_handler ]: 全局异常: 405 Method Not Allowed: The method is not allowed for the requested URL.
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 854, in dispatch_request
    self.raise_routing_exception(req)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 463, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/werkzeug/routing/map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
[ 2025-08-23 15:30:42 - WARNING - errors - page_not_found ]: 404错误: /comment/None/reply
[ 2025-08-23 15:31:17 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 15:31:17 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 15:31:18 - ERROR - __init__ - error_handler ]: 全局异常: Error 8 connecting to none:6379. nodename nor servname provided, or not known.
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 277, in connect
    sock = self.retry.call_with_retry(
        lambda: self._connect(), lambda error: self.disconnect(error)
    )
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/retry.py", line 62, in call_with_retry
    return do()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 278, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
            ~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 607, in _connect
    for res in socket.getaddrinfo(
               ~~~~~~~~~~~~~~~~~~^
        self.host, self.port, self.socket_type, socket.SOCK_STREAM
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 977, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_limiter/extension.py", line 1310, in __inner
    self.limiter._check_request_limit(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        in_middleware=False, callable_name=name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_limiter/extension.py", line 1187, in _check_request_limit
    raise e
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_limiter/extension.py", line 1169, in _check_request_limit
    self.__evaluate_limits(endpoint, all_limits)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_limiter/extension.py", line 1101, in __evaluate_limits
    if not method(lim.limit, *args, **kwargs):
           ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/limits/strategies.py", line 157, in hit
    self.storage.incr(
    ~~~~~~~~~~~~~~~~~^
        item.key_for(*identifiers),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
        item.get_expiry(),
        ^^^^^^^^^^^^^^^^^^
        amount=cost,
        ^^^^^^^^^^^^
    )
    ^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/limits/storage/base.py", line 25, in inner
    return fn(*args, **kwargs)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/limits/storage/redis.py", line 224, in incr
    return int(self.lua_incr_expire([key], [expiry, amount]))
               ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/commands/core.py", line 6296, in __call__
    return client.evalsha(self.sha, len(keys), *args)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/commands/core.py", line 5672, in evalsha
    return self._evalsha("EVALSHA", sha, numkeys, *keys_and_args)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/commands/core.py", line 5656, in _evalsha
    return self.execute_command(command, sha, numkeys, *keys_and_args)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/client.py", line 545, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 1074, in get_connection
    connection.connect()
    ~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 283, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 8 connecting to none:6379. nodename nor servname provided, or not known.
[ 2025-08-23 15:31:18 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 15:31:18 - ERROR - __init__ - error_handler ]: 全局异常: 405 Method Not Allowed: The method is not allowed for the requested URL.
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 854, in dispatch_request
    self.raise_routing_exception(req)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 463, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/werkzeug/routing/map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
[ 2025-08-23 15:31:18 - WARNING - errors - page_not_found ]: 404错误: /comment/None/reply
[ 2025-08-23 15:32:22 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 15:32:22 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 15:32:22 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 15:32:22 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 15:32:22 - ERROR - __init__ - error_handler ]: 全局异常: 405 Method Not Allowed: The method is not allowed for the requested URL.
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 854, in dispatch_request
    self.raise_routing_exception(req)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 463, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/werkzeug/routing/map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
[ 2025-08-23 15:32:22 - WARNING - errors - page_not_found ]: 404错误: /comment/None/reply
[ 2025-08-23 15:33:12 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 15:33:12 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 15:33:12 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 15:33:12 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 15:33:12 - ERROR - __init__ - error_handler ]: 全局异常: 405 Method Not Allowed: The method is not allowed for the requested URL.
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 854, in dispatch_request
    self.raise_routing_exception(req)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 463, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/werkzeug/routing/map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
[ 2025-08-23 15:33:12 - WARNING - errors - page_not_found ]: 404错误: /comment/None/reply
[ 2025-08-23 15:34:41 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 15:34:41 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 15:34:41 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 15:34:41 - INFO - comments - get_comments_new ]: 获取文章评论: post_id=1
[ 2025-08-23 15:34:41 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 15:34:41 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 15:34:41 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 15:34:41 - ERROR - __init__ - error_handler ]: 全局异常: 405 Method Not Allowed: The method is not allowed for the requested URL.
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 854, in dispatch_request
    self.raise_routing_exception(req)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 463, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/werkzeug/routing/map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
[ 2025-08-23 15:34:41 - WARNING - errors - page_not_found ]: 404错误: /comment/None/reply
[ 2025-08-23 15:36:04 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 15:36:04 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 15:36:04 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 15:36:05 - INFO - comments - get_comments_new ]: 获取文章评论: post_id=1
[ 2025-08-23 15:36:05 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 15:36:05 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 15:36:05 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 15:36:05 - WARNING - errors - page_not_found ]: 404错误: /post/2/comments/
[ 2025-08-23 15:36:05 - WARNING - errors - page_not_found ]: 404错误: /comment/None/reply
[ 2025-08-23 15:40:46 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 15:40:46 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 15:40:46 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 15:40:46 - INFO - comments - get_comments_new ]: 获取文章评论: post_id=1
[ 2025-08-23 15:40:46 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 15:40:46 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 15:40:46 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 15:40:46 - WARNING - errors - page_not_found ]: 404错误: /post/1/comments/
[ 2025-08-23 15:40:46 - WARNING - errors - page_not_found ]: 404错误: /post/1/comments/
[ 2025-08-23 15:44:03 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 15:44:03 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 15:44:03 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 15:44:03 - INFO - comments - get_comments_new ]: 获取文章评论: post_id=1
[ 2025-08-23 15:44:03 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 15:44:03 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 15:44:03 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 15:44:03 - WARNING - errors - page_not_found ]: 404错误: /post/1/
[ 2025-08-23 15:44:03 - WARNING - errors - page_not_found ]: 404错误: /post/1/



[ 2025-08-23 15:59:23 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 15:59:23 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 15:59:42 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 15:59:42 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 15:59:42 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 15:59:55 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 15:59:56 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 15:59:56 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 15:59:56 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:00:15 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:00:15 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:00:15 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:00:15 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:00:15 - INFO - comments - get_comment_replies ]: 获取评论回复
[ 2025-08-23 16:00:40 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:00:40 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:00:40 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:00:40 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:00:41 - INFO - comments - get_comment_replies ]: 获取评论回复
[ 2025-08-23 16:00:48 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:00:49 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:00:49 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:00:49 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:00:49 - INFO - comments - get_comment_replies ]: 获取评论回复
[ 2025-08-23 16:00:49 - INFO - praise - praise_comment ]: 评论点赞: id=1
[ 2025-08-23 16:00:53 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:00:54 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:00:54 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:00:54 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:00:54 - INFO - comments - get_comment_replies ]: 获取评论回复
[ 2025-08-23 16:00:54 - INFO - praise - praise_comment ]: 评论点赞: id=1
[ 2025-08-23 16:00:54 - INFO - praise - has_praised_comment_id ]: 查询用户已点赞评论: post_id=1
[ 2025-08-23 16:01:00 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:01:00 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:01:00 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:01:00 - INFO - comments - get_comments_new ]: 获取文章评论: post_id=1
[ 2025-08-23 16:01:00 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 16:01:00 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 16:01:01 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 16:01:01 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:01:01 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:01:01 - INFO - comments - get_comment_replies ]: 获取评论回复
[ 2025-08-23 16:01:01 - INFO - praise - praise_comment ]: 评论点赞: id=2
[ 2025-08-23 16:01:01 - INFO - praise - has_praised_comment_id ]: 查询用户已点赞评论: post_id=1
[ 2025-08-23 16:01:47 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:01:47 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:01:47 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:01:47 - INFO - comments - get_comments_new ]: 获取文章评论: post_id=1
[ 2025-08-23 16:01:47 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 16:01:47 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 16:01:47 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 16:01:47 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 16:01:47 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 16:01:47 - INFO - comments - get_comment_replies ]: 获取评论回复
[ 2025-08-23 16:01:47 - INFO - praise - praise_comment ]: 评论点赞: id=2
[ 2025-08-23 16:01:47 - INFO - praise - has_praised_comment_id ]: 查询用户已点赞评论: post_id=2
[ 2025-08-23 16:02:12 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:02:12 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 16:02:12 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 16:02:12 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 16:02:12 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 16:02:12 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 16:02:13 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 16:02:13 - INFO - users - get_user ]: 获取用户信息: id=2
[ 2025-08-23 16:02:13 - INFO - follow - follow ]: 关注用户: user2 -> test
[ 2025-08-23 16:02:13 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 16:02:13 - INFO - follow - unfollow ]: 取消关注用户: user2 -> test
[ 2025-08-23 16:02:13 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 16:02:30 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:04:12 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:04:13 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 16:04:13 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:04:13 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 16:04:22 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:04:23 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:04:23 - ERROR - __init__ - error_handler ]: 全局异常: 405 Method Not Allowed: The method is not allowed for the requested URL.
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 854, in dispatch_request
    self.raise_routing_exception(req)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 463, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/werkzeug/routing/map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
[ 2025-08-23 16:04:23 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 16:04:23 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 16:04:23 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:04:23 - INFO - posts - index ]: 创建新文章: user_id=4, post_id=3
[ 2025-08-23 16:04:23 - ERROR - __init__ - error_handler ]: 全局异常: 405 Method Not Allowed: The method is not allowed for the requested URL.
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 854, in dispatch_request
    self.raise_routing_exception(req)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 463, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/werkzeug/routing/map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
[ 2025-08-23 16:04:23 - WARNING - errors - page_not_found ]: 404错误: /comment/None/reply
[ 2025-08-23 16:04:23 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=4
[ 2025-08-23 16:04:23 - ERROR - __init__ - error_handler ]: 全局异常: 405 Method Not Allowed: The method is not allowed for the requested URL.
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 854, in dispatch_request
    self.raise_routing_exception(req)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 463, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/werkzeug/routing/map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
[ 2025-08-23 16:04:23 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:04:23 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=1
[ 2025-08-23 16:04:23 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:05:41 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:05:41 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:05:41 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:05:41 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:05:42 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 16:05:42 - INFO - praise - praise ]: 文章点赞: id=2
[ 2025-08-23 16:05:42 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:05:42 - INFO - posts - index ]: 创建新文章: user_id=4, post_id=3
[ 2025-08-23 16:05:42 - ERROR - __init__ - error_handler ]: 全局异常: 405 Method Not Allowed: The method is not allowed for the requested URL.
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 854, in dispatch_request
    self.raise_routing_exception(req)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 463, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/werkzeug/routing/map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
[ 2025-08-23 16:05:42 - WARNING - errors - page_not_found ]: 404错误: /comment/None/reply
[ 2025-08-23 16:05:42 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=4
[ 2025-08-23 16:05:42 - ERROR - __init__ - error_handler ]: 全局异常: 405 Method Not Allowed: The method is not allowed for the requested URL.
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 854, in dispatch_request
    self.raise_routing_exception(req)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 463, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/werkzeug/routing/map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
[ 2025-08-23 16:05:42 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:05:42 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=1
[ 2025-08-23 16:05:42 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:07:58 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:07:58 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:07:58 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:07:58 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:07:58 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 16:07:58 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 16:07:58 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:07:58 - INFO - posts - index ]: 创建新文章: user_id=4, post_id=3
[ 2025-08-23 16:07:58 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:07:59 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:07:59 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=4
[ 2025-08-23 16:07:59 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=4
[ 2025-08-23 16:07:59 - ERROR - __init__ - error_handler ]: 全局异常: 405 Method Not Allowed: The method is not allowed for the requested URL.
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 854, in dispatch_request
    self.raise_routing_exception(req)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 463, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/werkzeug/routing/map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
[ 2025-08-23 16:07:59 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:07:59 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=1
[ 2025-08-23 16:07:59 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:08:42 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:08:42 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:08:42 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:08:42 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:08:42 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 16:08:42 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 16:08:42 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:08:42 - INFO - posts - index ]: 创建新文章: user_id=4, post_id=3
[ 2025-08-23 16:08:42 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:08:42 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:08:42 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=4
[ 2025-08-23 16:08:43 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=4
[ 2025-08-23 16:08:43 - ERROR - __init__ - error_handler ]: 全局异常: 405 Method Not Allowed: The method is not allowed for the requested URL.
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 854, in dispatch_request
    self.raise_routing_exception(req)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 463, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/werkzeug/routing/map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
[ 2025-08-23 16:08:43 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:08:43 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=1
[ 2025-08-23 16:08:43 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:09:05 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:09:05 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:09:05 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 16:09:05 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:09:18 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:09:18 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:09:18 - ERROR - __init__ - error_handler ]: 全局异常: 405 Method Not Allowed: The method is not allowed for the requested URL.
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 854, in dispatch_request
    self.raise_routing_exception(req)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 463, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/werkzeug/routing/map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
[ 2025-08-23 16:09:18 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:10:09 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:10:09 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:10:09 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:10:09 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:10:09 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=1
[ 2025-08-23 16:10:09 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:10:48 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:10:48 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:10:48 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:10:48 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:10:48 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=1
[ 2025-08-23 16:10:48 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:11:01 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:11:01 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:11:01 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:11:01 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:11:01 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=1
[ 2025-08-23 16:11:01 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:14:27 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:14:27 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:14:27 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:14:27 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:14:27 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=1
[ 2025-08-23 16:14:27 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:14:39 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:14:39 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:14:39 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:14:39 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:14:40 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 16:14:40 - INFO - praise - praise ]: 文章点赞: id=2
[ 2025-08-23 16:14:40 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:14:40 - INFO - posts - index ]: 创建新文章: user_id=4, post_id=3
[ 2025-08-23 16:14:40 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 16:14:40 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 16:14:40 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=4
[ 2025-08-23 16:14:40 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=4
[ 2025-08-23 16:14:40 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 16:14:40 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:14:40 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=1
[ 2025-08-23 16:14:40 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:16:16 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:16:17 - ERROR - __init__ - error_handler ]: 全局异常: 'NoneType' object has no attribute 'email' and no __dict__ for setting new attributes
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_jwt_extended/view_decorators.py", line 170, in decorator
    return current_app.ensure_sync(fn)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/utils/time_util.py", line 57, in decorate
    result = func(*args, **kwargs)
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/auth/views.py", line 81, in apply_code
    current_user.email = request.get_json().get('email')
    ^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'email' and no __dict__ for setting new attributes
[ 2025-08-23 16:16:31 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:16:32 - ERROR - __init__ - error_handler ]: 全局异常: Authentication required.
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_jwt_extended/view_decorators.py", line 170, in decorator
    return current_app.ensure_sync(fn)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/auth/views.py", line 97, in confirm
    if current_user.confirm(email, code):
       ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/models.py", line 263, in confirm
    redis.delete(email)
    ~~~~~~~~~~~~^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/commands/core.py", line 1704, in delete
    return self.execute_command("DEL", *names)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/client.py", line 545, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 1074, in get_connection
    connection.connect()
    ~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 289, in connect
    self.on_connect()
    ~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 391, in on_connect
    self.read_response()
    ~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 512, in read_response
    response = self._parser.read_response(disable_decoding=disable_decoding)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/_parsers/resp2.py", line 15, in read_response
    result = self._read_response(disable_decoding=disable_decoding)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/_parsers/resp2.py", line 38, in _read_response
    raise error
redis.exceptions.AuthenticationError: Authentication required.
[ 2025-08-23 16:19:12 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:19:12 - ERROR - __init__ - error_handler ]: 全局异常: 'NoneType' object has no attribute 'email' and no __dict__ for setting new attributes
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_jwt_extended/view_decorators.py", line 170, in decorator
    return current_app.ensure_sync(fn)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/utils/time_util.py", line 57, in decorate
    result = func(*args, **kwargs)
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/auth/views.py", line 81, in apply_code
    current_user.email = request.get_json().get('email')
    ^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'email' and no __dict__ for setting new attributes
[ 2025-08-23 16:21:38 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:21:38 - ERROR - __init__ - error_handler ]: 全局异常: Authentication required.
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_jwt_extended/view_decorators.py", line 170, in decorator
    return current_app.ensure_sync(fn)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/auth/views.py", line 97, in confirm
    if current_user.confirm(email, code):
       ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/models.py", line 263, in confirm
    redis.delete(email)
    ~~~~~~~~~~~~^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/commands/core.py", line 1704, in delete
    return self.execute_command("DEL", *names)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/client.py", line 545, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 1074, in get_connection
    connection.connect()
    ~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 289, in connect
    self.on_connect()
    ~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 391, in on_connect
    self.read_response()
    ~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 512, in read_response
    response = self._parser.read_response(disable_decoding=disable_decoding)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/_parsers/resp2.py", line 15, in read_response
    result = self._read_response(disable_decoding=disable_decoding)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/_parsers/resp2.py", line 38, in _read_response
    raise error
redis.exceptions.AuthenticationError: Authentication required.
[ 2025-08-23 16:28:52 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:28:52 - ERROR - __init__ - error_handler ]: 全局异常: Authentication required.
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_jwt_extended/view_decorators.py", line 170, in decorator
    return current_app.ensure_sync(fn)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/auth/views.py", line 97, in confirm
    if current_user.confirm(email, code):
       ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/models.py", line 263, in confirm
    redis.delete(email)
    ~~~~~~~~~~~~^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/commands/core.py", line 1704, in delete
    return self.execute_command("DEL", *names)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/client.py", line 545, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 1074, in get_connection
    connection.connect()
    ~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 289, in connect
    self.on_connect()
    ~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 391, in on_connect
    self.read_response()
    ~~~~~~~~~~~~~~~~~~^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/connection.py", line 512, in read_response
    response = self._parser.read_response(disable_decoding=disable_decoding)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/_parsers/resp2.py", line 15, in read_response
    result = self._read_response(disable_decoding=disable_decoding)
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/redis/_parsers/resp2.py", line 38, in _read_response
    raise error
redis.exceptions.AuthenticationError: Authentication required.
[ 2025-08-23 16:32:16 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:32:16 - ERROR - __init__ - error_handler ]: 全局异常: TestPasswordResetCase.test_password_reset_flow.<locals>.mock_delete_code() takes 0 positional arguments but 1 was given
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_jwt_extended/view_decorators.py", line 170, in decorator
    return current_app.ensure_sync(fn)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/auth/views.py", line 97, in confirm
    if current_user.confirm(email, code):
       ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/models.py", line 263, in confirm
    redis.delete(email)
    ~~~~~~~~~~~~^^^^^^^
TypeError: TestPasswordResetCase.test_password_reset_flow.<locals>.mock_delete_code() takes 0 positional arguments but 1 was given
[ 2025-08-23 16:32:57 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:33:39 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:33:39 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 16:33:39 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:33:39 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 16:33:39 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:33:40 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:33:40 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:33:40 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:33:40 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 16:33:40 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 16:33:40 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:33:40 - INFO - posts - index ]: 创建新文章: user_id=4, post_id=3
[ 2025-08-23 16:33:40 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:33:40 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:33:40 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=4
[ 2025-08-23 16:33:40 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=4
[ 2025-08-23 16:33:40 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:33:40 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:33:40 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=1
[ 2025-08-23 16:33:40 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:33:40 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:33:41 - ERROR - __init__ - error_handler ]: 全局异常: 'NoneType' object has no attribute 'email' and no __dict__ for setting new attributes
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_jwt_extended/view_decorators.py", line 170, in decorator
    return current_app.ensure_sync(fn)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/utils/time_util.py", line 57, in decorate
    result = func(*args, **kwargs)
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/auth/views.py", line 81, in apply_code
    current_user.email = request.get_json().get('email')
    ^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'email' and no __dict__ for setting new attributes
[ 2025-08-23 16:33:41 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:33:41 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:33:41 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:33:41 - INFO - comments - get_comments_new ]: 获取文章评论: post_id=1
[ 2025-08-23 16:33:41 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 16:33:41 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 16:33:41 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 16:33:41 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 16:33:41 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 16:33:41 - INFO - comments - get_comment_replies ]: 获取评论回复
[ 2025-08-23 16:33:41 - INFO - praise - praise_comment ]: 评论点赞: id=2
[ 2025-08-23 16:33:41 - INFO - praise - has_praised_comment_id ]: 查询用户已点赞评论: post_id=2
[ 2025-08-23 16:33:41 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:33:41 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 16:33:41 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 16:33:41 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 16:33:41 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 16:33:41 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 16:33:42 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 16:33:42 - INFO - users - get_user ]: 获取用户信息: id=2
[ 2025-08-23 16:33:42 - INFO - follow - follow ]: 关注用户: user2 -> test
[ 2025-08-23 16:33:42 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 16:33:42 - INFO - follow - unfollow ]: 取消关注用户: user2 -> test
[ 2025-08-23 16:33:42 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 16:34:19 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:34:28 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:34:28 - ERROR - __init__ - error_handler ]: 全局异常: 'NoneType' object has no attribute 'email' and no __dict__ for setting new attributes
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_jwt_extended/view_decorators.py", line 170, in decorator
    return current_app.ensure_sync(fn)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/utils/time_util.py", line 57, in decorate
    result = func(*args, **kwargs)
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/auth/views.py", line 81, in apply_code
    current_user.email = request.get_json().get('email')
    ^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'email' and no __dict__ for setting new attributes
[ 2025-08-23 16:34:56 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:34:56 - ERROR - __init__ - error_handler ]: 全局异常: 'NoneType' object has no attribute 'email' and no __dict__ for setting new attributes
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_jwt_extended/view_decorators.py", line 170, in decorator
    return current_app.ensure_sync(fn)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/utils/time_util.py", line 57, in decorate
    result = func(*args, **kwargs)
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/auth/views.py", line 81, in apply_code
    current_user.email = request.get_json().get('email')
    ^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'email' and no __dict__ for setting new attributes
[ 2025-08-23 16:41:20 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:41:21 - ERROR - __init__ - error_handler ]: 全局异常: 'NoneType' object has no attribute 'email' and no __dict__ for setting new attributes
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask_jwt_extended/view_decorators.py", line 170, in decorator
    return current_app.ensure_sync(fn)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/utils/time_util.py", line 57, in decorate
    result = func(*args, **kwargs)
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/auth/views.py", line 81, in apply_code
    current_user.email = request.get_json().get('email')
    ^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'email' and no __dict__ for setting new attributes
[ 2025-08-23 16:41:35 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:43:56 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:51:16 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:51:31 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:51:31 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 16:51:32 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:51:32 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 16:51:32 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:51:32 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:51:32 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:51:32 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:51:32 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 16:51:32 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 16:51:32 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:51:32 - INFO - posts - index ]: 创建新文章: user_id=4, post_id=3
[ 2025-08-23 16:51:32 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:51:32 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:51:32 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=4
[ 2025-08-23 16:51:32 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=4
[ 2025-08-23 16:51:32 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:51:32 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:51:32 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=1
[ 2025-08-23 16:51:32 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:51:33 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:51:33 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:51:33 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:51:33 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:51:33 - INFO - comments - get_comments_new ]: 获取文章评论: post_id=1
[ 2025-08-23 16:51:33 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 16:51:33 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 16:51:33 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 16:51:33 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 16:51:33 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 16:51:33 - INFO - comments - get_comment_replies ]: 获取评论回复
[ 2025-08-23 16:51:33 - INFO - praise - praise_comment ]: 评论点赞: id=2
[ 2025-08-23 16:51:33 - INFO - praise - has_praised_comment_id ]: 查询用户已点赞评论: post_id=2
[ 2025-08-23 16:51:33 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:51:34 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 16:51:34 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 16:51:34 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 16:51:34 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 16:51:34 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 16:51:34 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 16:51:34 - INFO - users - get_user ]: 获取用户信息: id=2
[ 2025-08-23 16:51:34 - INFO - follow - follow ]: 关注用户: user2 -> test
[ 2025-08-23 16:51:34 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 16:51:34 - INFO - follow - unfollow ]: 取消关注用户: user2 -> test
[ 2025-08-23 16:51:34 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 16:53:28 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:54:38 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:55:52 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:55:52 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:55:52 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:55:52 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:55:52 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 16:55:53 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 16:55:53 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:55:53 - INFO - posts - index ]: 创建新文章: user_id=4, post_id=3
[ 2025-08-23 16:55:53 - INFO - comments - post ]: 发布评论: post_id=3
[ 2025-08-23 16:55:53 - INFO - comments - post ]: 发布评论: post_id=3
[ 2025-08-23 16:55:53 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=4
[ 2025-08-23 16:55:53 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=4
[ 2025-08-23 16:55:53 - INFO - comments - post ]: 发布评论: post_id=3
[ 2025-08-23 16:55:53 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:55:53 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=1
[ 2025-08-23 16:55:53 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:57:36 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:57:36 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:57:36 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:57:36 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:57:36 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 16:57:36 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 16:57:36 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:57:36 - INFO - posts - index ]: 创建新文章: user_id=4, post_id=3
[ 2025-08-23 16:57:36 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:57:36 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:57:36 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=4
[ 2025-08-23 16:57:36 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=4
[ 2025-08-23 16:57:37 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:57:37 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:57:37 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=1
[ 2025-08-23 16:57:37 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:57:40 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:57:40 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 16:57:40 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:57:40 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 16:57:40 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:57:40 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:57:40 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:57:40 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:57:40 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 16:57:40 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 16:57:40 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:57:41 - INFO - posts - index ]: 创建新文章: user_id=4, post_id=3
[ 2025-08-23 16:57:41 - INFO - comments - post ]: 发布评论: post_id=3
[ 2025-08-23 16:57:41 - INFO - comments - post ]: 发布评论: post_id=3
[ 2025-08-23 16:57:41 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=4
[ 2025-08-23 16:57:41 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=4
[ 2025-08-23 16:57:41 - INFO - comments - post ]: 发布评论: post_id=3
[ 2025-08-23 16:57:41 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:57:41 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=1
[ 2025-08-23 16:57:41 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 16:57:41 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:57:41 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:57:42 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 16:57:42 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 16:57:42 - INFO - comments - get_comments_new ]: 获取文章评论: post_id=1
[ 2025-08-23 16:57:42 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 16:57:42 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 16:57:42 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 16:57:42 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 16:57:42 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 16:57:42 - INFO - comments - get_comment_replies ]: 获取评论回复
[ 2025-08-23 16:57:42 - INFO - praise - praise_comment ]: 评论点赞: id=2
[ 2025-08-23 16:57:42 - INFO - praise - has_praised_comment_id ]: 查询用户已点赞评论: post_id=2
[ 2025-08-23 16:57:42 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 16:57:42 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 16:57:42 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 16:57:42 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 16:57:42 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 16:57:42 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 16:57:42 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 16:57:42 - INFO - users - get_user ]: 获取用户信息: id=2
[ 2025-08-23 16:57:42 - INFO - follow - follow ]: 关注用户: user2 -> test
[ 2025-08-23 16:57:42 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 16:57:42 - INFO - follow - unfollow ]: 取消关注用户: user2 -> test
[ 2025-08-23 16:57:42 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 17:22:43 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:22:44 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 17:22:44 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:22:44 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 17:22:44 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 17:22:44 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 17:22:44 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 17:22:44 - INFO - posts - index ]: 创建新文章: user_id=4, post_id=3
[ 2025-08-23 17:22:44 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:22:44 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:22:44 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=4
[ 2025-08-23 17:22:44 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=4
[ 2025-08-23 17:22:44 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:22:44 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 17:22:44 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=1
[ 2025-08-23 17:22:44 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 17:22:44 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:22:45 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:22:45 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 17:22:45 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 17:22:45 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 17:22:45 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:22:45 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 17:22:45 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:22:45 - INFO - comments - get_comments_new ]: 获取文章评论: post_id=1
[ 2025-08-23 17:22:45 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 17:22:45 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 17:22:45 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 17:22:45 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 17:22:46 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 17:22:46 - INFO - comments - get_comment_replies ]: 获取评论回复
[ 2025-08-23 17:22:46 - INFO - praise - praise_comment ]: 评论点赞: id=2
[ 2025-08-23 17:22:46 - INFO - praise - has_praised_comment_id ]: 查询用户已点赞评论: post_id=2
[ 2025-08-23 17:22:46 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:22:46 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 17:22:46 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 17:22:46 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 17:22:46 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 17:22:46 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 17:22:46 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 17:22:46 - INFO - users - get_user ]: 获取用户信息: id=2
[ 2025-08-23 17:22:46 - INFO - follow - follow ]: 关注用户: user2 -> test
[ 2025-08-23 17:22:46 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 17:22:46 - INFO - follow - unfollow ]: 取消关注用户: user2 -> test
[ 2025-08-23 17:22:46 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 17:43:03 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:43:03 - ERROR - __init__ - error_handler ]: 全局异常: 'NoneType' object has no attribute 'can'
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/main/posts.py", line 25, in index
    if request.method == "POST" and current_user.can(Permission.WRITE):
                                    ^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'can'
[ 2025-08-23 17:43:03 - INFO - posts - index ]: 创建新文章: user_id=2, post_id=1
[ 2025-08-23 17:43:04 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 17:43:04 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=2
[ 2025-08-23 17:43:04 - INFO - posts - index ]: 创建新文章: user_id=4, post_id=2
[ 2025-08-23 17:43:04 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 17:43:04 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 17:43:04 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=4
[ 2025-08-23 17:43:04 - INFO - posts - index ]: 创建新文章: user_id=5, post_id=3
[ 2025-08-23 17:43:04 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 17:43:04 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=5
[ 2025-08-23 17:43:04 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:43:05 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:43:05 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 17:43:05 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 17:43:05 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 17:43:05 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:43:05 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 17:43:05 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:43:05 - INFO - comments - get_comments_new ]: 获取文章评论: post_id=1
[ 2025-08-23 17:43:05 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 17:43:05 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 17:43:05 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 17:43:05 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 17:43:05 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 17:43:05 - INFO - comments - get_comment_replies ]: 获取评论回复
[ 2025-08-23 17:43:05 - INFO - praise - praise_comment ]: 评论点赞: id=2
[ 2025-08-23 17:43:05 - INFO - praise - has_praised_comment_id ]: 查询用户已点赞评论: post_id=2
[ 2025-08-23 17:43:05 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:43:05 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 17:43:05 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 17:43:05 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 17:43:05 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 17:43:05 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 17:43:06 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 17:43:06 - INFO - users - get_user ]: 获取用户信息: id=2
[ 2025-08-23 17:43:06 - INFO - follow - follow ]: 关注用户: user2 -> test
[ 2025-08-23 17:43:06 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 17:43:06 - INFO - follow - unfollow ]: 取消关注用户: user2 -> test
[ 2025-08-23 17:43:06 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 17:44:33 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:44:33 - ERROR - __init__ - error_handler ]: 全局异常: 'NoneType' object has no attribute 'can'
Traceback (most recent call last):
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/nizhenshi/Documents/proj/loft/backend/.venv/lib/python3.13/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/nizhenshi/Documents/proj/loft/backend/app/main/posts.py", line 25, in index
    if request.method == "POST" and current_user.can(Permission.WRITE):
                                    ^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'can'
[ 2025-08-23 17:44:34 - INFO - posts - index ]: 创建新文章: user_id=2, post_id=1
[ 2025-08-23 17:44:34 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 17:44:34 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=2
[ 2025-08-23 17:44:34 - INFO - posts - index ]: 创建新文章: user_id=4, post_id=2
[ 2025-08-23 17:44:34 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:44:34 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:44:34 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=4
[ 2025-08-23 17:44:34 - INFO - posts - index ]: 创建新文章: user_id=5, post_id=3
[ 2025-08-23 17:44:34 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:44:34 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=5
[ 2025-08-23 17:44:34 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:44:35 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:44:35 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 17:44:35 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 17:44:35 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 17:44:35 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:44:35 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 17:44:35 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:44:35 - INFO - comments - get_comments_new ]: 获取文章评论: post_id=1
[ 2025-08-23 17:44:35 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 17:44:35 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 17:44:35 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 17:44:35 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 17:44:35 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 17:44:35 - INFO - comments - get_comment_replies ]: 获取评论回复
[ 2025-08-23 17:44:35 - INFO - praise - praise_comment ]: 评论点赞: id=2
[ 2025-08-23 17:44:35 - INFO - praise - has_praised_comment_id ]: 查询用户已点赞评论: post_id=2
[ 2025-08-23 17:44:35 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:44:35 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 17:44:35 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 17:44:35 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 17:44:36 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 17:44:36 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 17:44:36 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 17:44:36 - INFO - users - get_user ]: 获取用户信息: id=2
[ 2025-08-23 17:44:36 - INFO - follow - follow ]: 关注用户: user2 -> test
[ 2025-08-23 17:44:36 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 17:44:36 - INFO - follow - unfollow ]: 取消关注用户: user2 -> test
[ 2025-08-23 17:44:36 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 17:47:30 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:47:30 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 17:47:30 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:47:30 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 17:47:30 - INFO - posts - index ]: 创建新文章: user_id=3, post_id=2
[ 2025-08-23 17:47:30 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 17:47:30 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=3
[ 2025-08-23 17:47:30 - INFO - posts - index ]: 创建新文章: user_id=5, post_id=3
[ 2025-08-23 17:47:30 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:47:30 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:47:30 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=5
[ 2025-08-23 17:47:30 - INFO - posts - index ]: 创建新文章: user_id=6, post_id=4
[ 2025-08-23 17:47:31 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:47:31 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=6
[ 2025-08-23 17:47:31 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:47:31 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:47:31 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 17:47:31 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 17:47:31 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 17:47:31 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:47:32 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 17:47:32 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:47:32 - INFO - comments - get_comments_new ]: 获取文章评论: post_id=1
[ 2025-08-23 17:47:32 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 17:47:32 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 17:47:32 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 17:47:32 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 17:47:32 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 17:47:32 - INFO - comments - get_comment_replies ]: 获取评论回复
[ 2025-08-23 17:47:32 - INFO - praise - praise_comment ]: 评论点赞: id=2
[ 2025-08-23 17:47:32 - INFO - praise - has_praised_comment_id ]: 查询用户已点赞评论: post_id=2
[ 2025-08-23 17:47:32 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:47:32 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 17:47:32 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 17:47:32 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 17:47:32 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 17:47:32 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 17:47:32 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 17:47:32 - INFO - users - get_user ]: 获取用户信息: id=2
[ 2025-08-23 17:47:32 - INFO - follow - follow ]: 关注用户: user2 -> test
[ 2025-08-23 17:47:32 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 17:47:32 - INFO - follow - unfollow ]: 取消关注用户: user2 -> test
[ 2025-08-23 17:47:32 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 17:50:34 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:50:34 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 17:50:34 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:50:34 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 17:50:34 - INFO - posts - index ]: 创建新文章: user_id=3, post_id=2
[ 2025-08-23 17:50:34 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 17:50:35 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=3
[ 2025-08-23 17:50:35 - INFO - posts - index ]: 创建新文章: user_id=5, post_id=3
[ 2025-08-23 17:50:35 - INFO - comments - post ]: 发布评论: post_id=3
[ 2025-08-23 17:50:35 - INFO - comments - post ]: 发布评论: post_id=3
[ 2025-08-23 17:50:35 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=5
[ 2025-08-23 17:50:35 - INFO - posts - index ]: 创建新文章: user_id=6, post_id=4
[ 2025-08-23 17:50:35 - INFO - comments - post ]: 发布评论: post_id=3
[ 2025-08-23 17:50:35 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=6
[ 2025-08-23 17:52:01 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:52:01 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 17:52:01 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:52:01 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 17:52:01 - INFO - posts - index ]: 创建新文章: user_id=3, post_id=2
[ 2025-08-23 17:52:01 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 17:52:01 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=3
[ 2025-08-23 17:52:01 - INFO - posts - index ]: 创建新文章: user_id=5, post_id=3
[ 2025-08-23 17:52:01 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:52:02 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:52:02 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=5
[ 2025-08-23 17:52:02 - INFO - posts - index ]: 创建新文章: user_id=6, post_id=4
[ 2025-08-23 17:52:02 - INFO - comments - post ]: 发布评论: post_id=4
[ 2025-08-23 17:52:02 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=6
[ 2025-08-23 17:52:02 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=6
[ 2025-08-23 17:52:02 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=6
[ 2025-08-23 17:53:22 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:53:22 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 17:53:22 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:53:22 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 17:53:23 - INFO - posts - index ]: 创建新文章: user_id=3, post_id=2
[ 2025-08-23 17:53:23 - INFO - praise - praise ]: 文章点赞: id=2
[ 2025-08-23 17:53:23 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=3
[ 2025-08-23 17:53:23 - INFO - posts - index ]: 创建新文章: user_id=5, post_id=3
[ 2025-08-23 17:53:23 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 17:53:23 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 17:53:23 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=5
[ 2025-08-23 17:53:23 - INFO - posts - index ]: 创建新文章: user_id=6, post_id=4
[ 2025-08-23 17:53:23 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 17:53:23 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=6
[ 2025-08-23 17:53:47 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:53:47 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 17:53:47 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:53:47 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 17:53:47 - INFO - posts - index ]: 创建新文章: user_id=3, post_id=2
[ 2025-08-23 17:53:47 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 17:53:47 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=3
[ 2025-08-23 17:53:47 - INFO - posts - index ]: 创建新文章: user_id=5, post_id=3
[ 2025-08-23 17:53:47 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:53:47 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:53:47 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=5
[ 2025-08-23 17:53:47 - INFO - posts - index ]: 创建新文章: user_id=6, post_id=4
[ 2025-08-23 17:53:48 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:53:48 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=6
[ 2025-08-23 17:57:22 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:57:22 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 17:57:22 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:57:22 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 17:57:22 - INFO - posts - index ]: 创建新文章: user_id=3, post_id=2
[ 2025-08-23 17:57:22 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 17:57:22 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=3
[ 2025-08-23 17:57:22 - INFO - posts - index ]: 创建新文章: user_id=5, post_id=3
[ 2025-08-23 17:57:22 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:57:22 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:57:23 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=5
[ 2025-08-23 17:57:23 - INFO - posts - index ]: 创建新文章: user_id=6, post_id=4
[ 2025-08-23 17:57:23 - INFO - comments - post ]: 发布评论: post_id=4
[ 2025-08-23 17:57:23 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=6
[ 2025-08-23 17:57:23 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=6
[ 2025-08-23 17:57:23 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=6
[ 2025-08-23 17:59:07 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:59:08 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 17:59:08 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:59:08 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 17:59:08 - INFO - posts - index ]: 创建新文章: user_id=3, post_id=2
[ 2025-08-23 17:59:08 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 17:59:08 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=3
[ 2025-08-23 17:59:08 - INFO - posts - index ]: 创建新文章: user_id=5, post_id=3
[ 2025-08-23 17:59:08 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:59:08 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:59:08 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=5
[ 2025-08-23 17:59:08 - INFO - posts - index ]: 创建新文章: user_id=7, post_id=4
[ 2025-08-23 17:59:08 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:59:08 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=7
[ 2025-08-23 17:59:39 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 17:59:39 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 17:59:39 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:59:39 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 17:59:39 - INFO - posts - index ]: 创建新文章: user_id=3, post_id=2
[ 2025-08-23 17:59:39 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 17:59:39 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=3
[ 2025-08-23 17:59:39 - INFO - posts - index ]: 创建新文章: user_id=5, post_id=3
[ 2025-08-23 17:59:39 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:59:40 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 17:59:40 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=5
[ 2025-08-23 17:59:40 - INFO - posts - index ]: 创建新文章: user_id=7, post_id=4
[ 2025-08-23 17:59:40 - INFO - comments - post ]: 发布评论: post_id=4
[ 2025-08-23 17:59:40 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=7
[ 2025-08-23 17:59:40 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=7
[ 2025-08-23 17:59:40 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=7
[ 2025-08-23 18:00:29 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:00:30 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 18:00:30 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 18:00:30 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 18:00:30 - INFO - posts - index ]: 创建新文章: user_id=3, post_id=2
[ 2025-08-23 18:00:30 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 18:00:30 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=3
[ 2025-08-23 18:00:30 - INFO - posts - index ]: 创建新文章: user_id=5, post_id=3
[ 2025-08-23 18:00:30 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 18:00:30 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 18:00:30 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=5
[ 2025-08-23 18:00:30 - INFO - posts - index ]: 创建新文章: user_id=7, post_id=4
[ 2025-08-23 18:00:30 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 18:00:30 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=7
[ 2025-08-23 18:01:17 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:01:17 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 18:01:17 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 18:01:17 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 18:01:17 - INFO - posts - index ]: 创建新文章: user_id=3, post_id=2
[ 2025-08-23 18:01:17 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 18:01:17 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=3
[ 2025-08-23 18:01:17 - INFO - posts - index ]: 创建新文章: user_id=5, post_id=3
[ 2025-08-23 18:01:17 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 18:01:17 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 18:01:18 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=5
[ 2025-08-23 18:01:18 - INFO - posts - index ]: 创建新文章: user_id=7, post_id=4
[ 2025-08-23 18:01:18 - INFO - comments - post ]: 发布评论: post_id=4
[ 2025-08-23 18:01:18 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=7
[ 2025-08-23 18:01:18 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=7
[ 2025-08-23 18:01:18 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=7
[ 2025-08-23 18:01:44 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:01:44 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 18:01:44 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 18:01:44 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 18:17:00 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:19:42 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:20:52 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:20:52 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:21:04 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 18:26:24 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:26:25 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:28:44 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:28:45 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 18:28:45 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 18:28:45 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 18:28:45 - INFO - posts - index ]: 创建新文章: user_id=3, post_id=2
[ 2025-08-23 18:28:45 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 18:28:45 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=3
[ 2025-08-23 18:28:45 - INFO - posts - index ]: 创建新文章: user_id=5, post_id=3
[ 2025-08-23 18:28:45 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 18:28:45 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 18:28:45 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=5
[ 2025-08-23 18:28:45 - INFO - posts - index ]: 创建新文章: user_id=7, post_id=4
[ 2025-08-23 18:28:45 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 18:28:45 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=7
[ 2025-08-23 18:28:45 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:28:46 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:28:46 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 18:28:46 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 18:28:46 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 18:28:46 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:28:46 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 18:28:46 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 18:28:46 - INFO - comments - get_comments_new ]: 获取文章评论: post_id=1
[ 2025-08-23 18:28:46 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 18:28:46 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 18:28:46 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 18:28:46 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 18:28:46 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 18:28:46 - INFO - comments - get_comment_replies ]: 获取评论回复
[ 2025-08-23 18:28:46 - INFO - praise - praise_comment ]: 评论点赞: id=2
[ 2025-08-23 18:28:46 - INFO - praise - has_praised_comment_id ]: 查询用户已点赞评论: post_id=2
[ 2025-08-23 18:28:46 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:28:47 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 18:28:47 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 18:28:47 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 18:28:47 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 18:28:47 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 18:28:47 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 18:28:47 - INFO - users - get_user ]: 获取用户信息: id=2
[ 2025-08-23 18:28:47 - INFO - follow - follow ]: 关注用户: user2 -> test
[ 2025-08-23 18:28:47 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 18:28:47 - INFO - follow - unfollow ]: 取消关注用户: user2 -> test
[ 2025-08-23 18:28:47 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 18:29:50 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:29:52 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:29:54 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:29:54 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 18:29:54 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 18:29:54 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 18:29:54 - INFO - posts - index ]: 创建新文章: user_id=3, post_id=2
[ 2025-08-23 18:29:54 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 18:29:54 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=3
[ 2025-08-23 18:29:55 - INFO - posts - index ]: 创建新文章: user_id=5, post_id=3
[ 2025-08-23 18:29:55 - INFO - comments - post ]: 发布评论: post_id=3
[ 2025-08-23 18:29:55 - INFO - comments - post ]: 发布评论: post_id=3
[ 2025-08-23 18:29:55 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=5
[ 2025-08-23 18:29:55 - INFO - posts - index ]: 创建新文章: user_id=7, post_id=4
[ 2025-08-23 18:29:55 - INFO - comments - post ]: 发布评论: post_id=3
[ 2025-08-23 18:29:55 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=7
[ 2025-08-23 18:29:55 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:29:56 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:29:56 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 18:29:56 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 18:29:56 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 18:29:56 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:29:56 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 18:29:56 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 18:29:56 - INFO - comments - get_comments_new ]: 获取文章评论: post_id=1
[ 2025-08-23 18:29:56 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 18:29:56 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 18:29:56 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 18:29:56 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 18:29:56 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 18:29:56 - INFO - comments - get_comment_replies ]: 获取评论回复
[ 2025-08-23 18:29:56 - INFO - praise - praise_comment ]: 评论点赞: id=2
[ 2025-08-23 18:29:56 - INFO - praise - has_praised_comment_id ]: 查询用户已点赞评论: post_id=2
[ 2025-08-23 18:29:56 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:29:56 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 18:29:56 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 18:29:56 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 18:29:56 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 18:29:56 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 18:29:57 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 18:29:57 - INFO - users - get_user ]: 获取用户信息: id=2
[ 2025-08-23 18:29:57 - INFO - follow - follow ]: 关注用户: user2 -> test
[ 2025-08-23 18:29:57 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 18:29:57 - INFO - follow - unfollow ]: 取消关注用户: user2 -> test
[ 2025-08-23 18:29:57 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 18:30:26 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:30:50 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:30:54 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:31:35 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:31:35 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:31:35 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 18:31:35 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 18:31:35 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 18:31:35 - INFO - posts - index ]: 创建新文章: user_id=3, post_id=2
[ 2025-08-23 18:31:36 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 18:31:36 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=3
[ 2025-08-23 18:31:36 - INFO - posts - index ]: 创建新文章: user_id=5, post_id=3
[ 2025-08-23 18:31:36 - INFO - comments - post ]: 发布评论: post_id=3
[ 2025-08-23 18:31:36 - INFO - comments - post ]: 发布评论: post_id=3
[ 2025-08-23 18:31:36 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=5
[ 2025-08-23 18:31:36 - INFO - posts - index ]: 创建新文章: user_id=7, post_id=4
[ 2025-08-23 18:31:36 - INFO - comments - post ]: 发布评论: post_id=3
[ 2025-08-23 18:31:36 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=7
[ 2025-08-23 18:31:36 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:31:36 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:31:37 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 18:31:37 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 18:31:37 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 18:31:37 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:31:37 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 18:31:37 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 18:31:37 - INFO - comments - get_comments_new ]: 获取文章评论: post_id=1
[ 2025-08-23 18:31:37 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 18:31:37 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 18:31:37 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 18:31:37 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 18:31:37 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 18:31:37 - INFO - comments - get_comment_replies ]: 获取评论回复
[ 2025-08-23 18:31:37 - INFO - praise - praise_comment ]: 评论点赞: id=2
[ 2025-08-23 18:31:37 - INFO - praise - has_praised_comment_id ]: 查询用户已点赞评论: post_id=2
[ 2025-08-23 18:31:37 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:31:37 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 18:31:37 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 18:31:37 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 18:31:37 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 18:31:37 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 18:31:37 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 18:31:37 - INFO - users - get_user ]: 获取用户信息: id=2
[ 2025-08-23 18:31:37 - INFO - follow - follow ]: 关注用户: user2 -> test
[ 2025-08-23 18:31:37 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 18:31:37 - INFO - follow - unfollow ]: 取消关注用户: user2 -> test
[ 2025-08-23 18:31:37 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 18:31:50 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:32:08 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:32:16 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:32:20 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:32:22 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:32:24 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:32:25 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 18:32:25 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 18:32:25 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 18:32:25 - INFO - posts - index ]: 创建新文章: user_id=3, post_id=2
[ 2025-08-23 18:32:25 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 18:32:25 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 18:32:25 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=3
[ 2025-08-23 18:32:25 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:32:25 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:32:25 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 18:32:26 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 18:32:26 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 18:32:26 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:32:26 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 18:32:26 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 18:32:26 - INFO - comments - get_comments_new ]: 获取文章评论: post_id=1
[ 2025-08-23 18:32:26 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 18:32:26 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 18:32:26 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=2
[ 2025-08-23 18:32:26 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 18:32:26 - INFO - comments - post ]: 发布评论: post_id=2
[ 2025-08-23 18:32:26 - INFO - comments - get_comment_replies ]: 获取评论回复
[ 2025-08-23 18:32:26 - INFO - praise - praise_comment ]: 评论点赞: id=2
[ 2025-08-23 18:32:26 - INFO - praise - has_praised_comment_id ]: 查询用户已点赞评论: post_id=2
[ 2025-08-23 18:32:26 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:32:26 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 18:32:26 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 18:32:26 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 18:32:26 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 18:32:26 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 18:32:26 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 18:32:26 - INFO - users - get_user ]: 获取用户信息: id=2
[ 2025-08-23 18:32:26 - INFO - follow - follow ]: 关注用户: user2 -> test
[ 2025-08-23 18:32:26 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 18:32:26 - INFO - follow - unfollow ]: 取消关注用户: user2 -> test
[ 2025-08-23 18:32:26 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 18:33:03 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:33:08 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:33:22 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:39:28 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:39:38 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 18:40:02 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 19:25:32 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:05 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:05 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:33:05 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:33:05 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 19:33:05 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:05 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:33:05 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:33:05 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:33:05 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 19:33:05 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:06 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:06 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 19:33:06 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:06 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:33:06 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 19:33:06 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:06 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:33:06 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:33:06 - INFO - comments - get_comments_new ]: 获取文章评论: post_id=1
[ 2025-08-23 19:33:06 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 19:33:06 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 19:33:06 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:07 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:33:07 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:33:07 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:33:07 - INFO - comments - get_comment_replies ]: 获取评论回复
[ 2025-08-23 19:33:07 - INFO - praise - praise_comment ]: 评论点赞: id=1
[ 2025-08-23 19:33:07 - INFO - praise - has_praised_comment_id ]: 查询用户已点赞评论: post_id=1
[ 2025-08-23 19:33:07 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:07 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 19:33:07 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 19:33:07 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 19:33:07 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:07 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 19:33:07 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 19:33:07 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:07 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 19:33:07 - INFO - users - get_user ]: 获取用户信息: id=2
[ 2025-08-23 19:33:07 - INFO - follow - follow ]: 关注用户: user2 -> user1
[ 2025-08-23 19:33:07 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 19:33:07 - INFO - follow - unfollow ]: 取消关注用户: user2 -> user1
[ 2025-08-23 19:33:07 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 19:33:26 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:26 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:33:26 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:33:26 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 19:33:26 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:26 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:33:26 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:33:27 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:33:27 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 19:33:27 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:27 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:33:27 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:33:27 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 19:33:27 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=1
[ 2025-08-23 19:33:27 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 19:33:27 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:27 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:27 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 19:33:27 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:28 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:33:28 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 19:33:28 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:28 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:33:28 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:33:28 - INFO - comments - get_comments_new ]: 获取文章评论: post_id=1
[ 2025-08-23 19:33:28 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 19:33:28 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 19:33:28 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:28 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:33:28 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:33:28 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:33:28 - INFO - comments - get_comment_replies ]: 获取评论回复
[ 2025-08-23 19:33:28 - INFO - praise - praise_comment ]: 评论点赞: id=1
[ 2025-08-23 19:33:28 - INFO - praise - has_praised_comment_id ]: 查询用户已点赞评论: post_id=1
[ 2025-08-23 19:33:28 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:28 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 19:33:28 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 19:33:28 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 19:33:28 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:29 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 19:33:29 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 19:33:29 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:29 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 19:33:29 - INFO - users - get_user ]: 获取用户信息: id=2
[ 2025-08-23 19:33:29 - INFO - follow - follow ]: 关注用户: user2 -> user1
[ 2025-08-23 19:33:29 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 19:33:29 - INFO - follow - unfollow ]: 取消关注用户: user2 -> user1
[ 2025-08-23 19:33:29 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 19:33:43 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:43 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:33:43 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:33:43 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 19:33:43 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:43 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:33:43 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 19:33:43 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 19:33:43 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:44 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:33:44 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:33:44 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:33:44 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 19:33:44 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:44 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:33:44 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:33:44 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 19:33:44 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=1
[ 2025-08-23 19:33:44 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 19:33:44 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:44 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:45 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 19:33:45 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:45 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:33:45 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 19:33:45 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:45 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:33:45 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:33:45 - INFO - comments - get_comments_new ]: 获取文章评论: post_id=1
[ 2025-08-23 19:33:45 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 19:33:45 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 19:33:45 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:45 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:33:45 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:33:45 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:33:45 - INFO - comments - get_comment_replies ]: 获取评论回复
[ 2025-08-23 19:33:45 - INFO - praise - praise_comment ]: 评论点赞: id=1
[ 2025-08-23 19:33:45 - INFO - praise - has_praised_comment_id ]: 查询用户已点赞评论: post_id=1
[ 2025-08-23 19:33:45 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:45 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 19:33:45 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 19:33:45 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 19:33:45 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:46 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 19:33:46 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 19:33:46 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:33:46 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 19:33:46 - INFO - users - get_user ]: 获取用户信息: id=2
[ 2025-08-23 19:33:46 - INFO - follow - follow ]: 关注用户: user2 -> user1
[ 2025-08-23 19:33:46 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 19:33:46 - INFO - follow - unfollow ]: 取消关注用户: user2 -> user1
[ 2025-08-23 19:33:46 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 19:50:24 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:50:24 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:50:25 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:50:25 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 19:50:25 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:50:25 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:50:25 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 19:50:25 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 19:50:25 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:50:25 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:50:25 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:50:25 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:50:25 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 19:50:25 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:50:25 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:50:26 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:50:26 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 19:50:26 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=1
[ 2025-08-23 19:50:26 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 19:50:26 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:50:26 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:50:26 - INFO - posts - get_posts ]: 获取文章列表
[ 2025-08-23 19:50:26 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:50:26 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:50:26 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=3
[ 2025-08-23 19:50:26 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:50:26 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:50:26 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:50:26 - INFO - comments - get_comments_new ]: 获取文章评论: post_id=1
[ 2025-08-23 19:50:26 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 19:50:26 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 19:50:27 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:50:27 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:50:27 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:50:27 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:50:27 - INFO - comments - get_comment_replies ]: 获取评论回复
[ 2025-08-23 19:50:27 - INFO - praise - praise_comment ]: 评论点赞: id=1
[ 2025-08-23 19:50:27 - INFO - praise - has_praised_comment_id ]: 查询用户已点赞评论: post_id=1
[ 2025-08-23 19:50:27 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:50:27 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 19:50:27 - INFO - users - get_user ]: 获取用户信息: id=999
[ 2025-08-23 19:50:27 - WARNING - errors - page_not_found ]: 404错误: /api/v1/users/999
[ 2025-08-23 19:50:27 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:50:27 - INFO - users - update_user_profile ]: 更新用户信息: user_id=1
[ 2025-08-23 19:50:27 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 19:50:27 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:50:27 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 19:50:27 - INFO - users - get_user ]: 获取用户信息: id=2
[ 2025-08-23 19:50:27 - INFO - follow - follow ]: 关注用户: user2 -> user1
[ 2025-08-23 19:50:27 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 19:50:27 - INFO - follow - unfollow ]: 取消关注用户: user2 -> user1
[ 2025-08-23 19:50:27 - INFO - users - get_user ]: 获取用户信息: id=1
[ 2025-08-23 19:50:39 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:50:39 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:50:39 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:50:39 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 19:50:39 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:50:40 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:50:40 - INFO - praise - praise ]: 文章点赞: id=1
[ 2025-08-23 19:50:40 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 19:50:40 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:50:40 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:50:40 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:50:40 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:50:40 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 19:50:40 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 19:50:40 - INFO - posts - index ]: 创建新文章: user_id=1, post_id=1
[ 2025-08-23 19:50:40 - INFO - comments - post ]: 发布评论: post_id=1
[ 2025-08-23 19:50:40 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 19:50:40 - INFO - notifications - mark_read_notification ]: 标记通知已读: user_id=1
[ 2025-08-23 19:50:40 - INFO - notifications - get_currentUsernotification ]: 获取用户通知: user_id=1
[ 2025-08-23 20:50:29 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 20:51:06 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 20:51:37 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 20:52:06 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 20:52:35 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
[ 2025-08-23 20:53:01 - INFO - logger - init_app ]: 日志系统初始化完成，日志级别: INFO
